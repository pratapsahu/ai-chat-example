<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Chat Bot</title>
		<link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" />
		<style>
			body {
				padding-top: 50px;
			}
			.bubble {
				background-color: #e0e0e0;
				padding: 5px 10px;
				border-radius: 15px;
				display: inline-block;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="panel panel-default">
				<div class="panel-heading">
					<span>Conversation here...</span>
					<button type="button" class="btn btn-default" id="clearMessage">Clear</button>
					<button type="button" class="btn btn-default" id="exportMessage">Export</button>
				</div>
				<div class="panel-body" id="conversationBox"></div>
			</div>
			<div class="input-group">
				<input type="text" class="form-control width100" id="inputMessage" />				
				<span class="input-group-btn">
					<button type="button" class="btn btn-default" id="goMessage">Go</button>
				</span>				
			</div>
		</div>
		
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script type="text/javascript">
			var welcomeMessage = 'Welcome to personal assistance. How may I help you ?';
			function sendMessage(){
				var inputMessage = $("#inputMessage").val();				
				var data = {};
				
				$('#conversationBox').append('<div class="text-right"><span class="bubble">'+inputMessage+'</span></div><br/>');
				data.message = inputMessage;
				
				$.ajax({
					type: 'POST',
					url: '/submit-message',
					data: data,
					dataType: 'json',
					success: function(res){
						//alert('success');
						//alert(res);
						$('#conversationBox').append('<div class="text-left"><span class="bubble">'+res.replyMessage+'</span></div>');
						$('#inputMessage').val('');
					},
					complete: function(){
						//alert('complete');
					}
				});
			}
			$(document).ready(function(){
				//alert('ready');
				$('#conversationBox').append('<div class="text-left"><span class="bubble">'+welcomeMessage+'</span></div>');
				
				$('#goMessage').click(sendMessage);
				
				$('#inputMessage').onEnter(sendMessage);
				
				$('#clearMessage').click(function(){
					$('#conversationBox').html('');
				});
				$('#exportMessage').click(function(){
					//Export messages
				});
			});
			
			(function($){
				$.fn.onEnter = function(func){
					this.bind('keypress', function(e){
						if(e.keyCode === 13){
							func.apply(this, [e]);
						}
					});
					return this;
				};
			})(jQuery);
		</script>
	</body>
</html>